# 🔒 移动端 HTTPS 访问完整指南

## 🎯 目标

启用 HTTPS 环境，既解决连接问题，又支持媒体设备（麦克风、摄像头）访问。

## 📋 当前配置

- ✅ 已启用 `@vitejs/plugin-basic-ssl` 自动生成 SSL 证书
- ✅ 配置 `https: true` 和 `host: '0.0.0.0'`
- ✅ 开发服务器正在以 HTTPS 模式重新启动

## 📱 移动端访问步骤

### 第一步：访问 HTTPS 地址

用手机浏览器访问：

```
https://172.20.10.2:5173
```

**注意：现在使用 `https://` 而不是 `http://`**

### 第二步：处理安全警告

因为使用的是自签名证书，浏览器会显示安全警告：

#### 🤖 Android Chrome/Edge

1. 看到"您的连接不是私密连接"页面
2. 点击**"高级"**按钮
3. 点击**"继续前往 172.20.10.2（不安全）"**
4. 页面就能正常加载了

#### 🍎 iOS Safari

1. 看到"此连接不是私人连接"页面
2. 点击**"显示详细信息"**
3. 点击**"访问此网站"**
4. 再次点击**"访问网站"**确认

#### 📱 其他浏览器

- **华为浏览器**：点击"继续访问"
- **小米浏览器**：点击"仍要继续"
- **UC 浏览器**：点击"忽略风险并继续"

### 第三步：授权媒体权限

成功访问页面后，使用语音分析功能时：

1. 浏览器会弹出权限请求对话框
2. 选择**"允许"**或**"Allow"**
3. 可能需要在浏览器设置中手动开启权限

## 🔧 权限设置详解

### Android Chrome 权限设置

1. 访问网站后，点击地址栏的**锁形图标**
2. 选择**"网站设置"**
3. 将**麦克风**和**摄像头**设置为**"允许"**
4. 刷新页面

### iOS Safari 权限设置

1. 系统设置 → Safari → 摄像头/麦克风
2. 选择**"询问"**或**"允许"**
3. 回到 Safari 刷新页面
4. 当网站请求权限时选择"允许"

## ✅ 功能测试清单

访问成功后，请依次测试：

### 🎯 基础功能

- [ ] 页面能正常加载
- [ ] 导航功能正常
- [ ] 用户界面显示正常

### 🎤 媒体设备功能

- [ ] 访问 **语音分析** 页面
- [ ] 点击"开始声音收集"按钮
- [ ] 浏览器提示权限请求
- [ ] 允许权限后能看到声波图动画
- [ ] 能正常录制和分析声音

### 📹 摄像头功能

- [ ] 访问 **视觉行为分析** 页面
- [ ] 摄像头权限正常申请
- [ ] 能正常显示视频预览

## 🚨 常见问题解决

### Q: 页面显示"无法访问此网站"

**A:** 确保：

- 使用 `https://` 而不是 `http://`
- IP 地址正确：`172.20.10.2:5173`
- 开发服务器正在运行

### Q: 安全警告无法跳过

**A:** 尝试：

- 清除浏览器缓存和数据
- 使用不同的浏览器
- 重启手机后再试

### Q: 权限请求不显示

**A:** 检查：

- 是否已在浏览器设置中禁用了权限
- 尝试手动在浏览器设置中开启权限
- 完全关闭浏览器重新打开

### Q: 声音收集显示兼容性问题

**A:** 这种情况下：

- 首先确认使用的是 HTTPS 地址
- 检查浏览器是否支持媒体设备
- 访问 `/mobile-media-test` 页面进行详细测试

## 🔍 测试工具

应用内置了测试页面：

- **权限测试**：访问 `/mobile-media-test`
- **环境指南**：访问 `/dev-environment-guide`

## 🎉 预期结果

配置成功后：

- ✅ HTTPS 连接正常
- ✅ 页面加载无问题
- ✅ 媒体设备权限正常
- ✅ 语音分析功能完全可用
- ✅ 视觉分析功能完全可用
- ✅ 所有功能都能在移动端正常使用

## 💡 提示

- 自签名证书的安全警告是正常的，这不影响功能使用
- 首次访问需要手动接受证书，后续访问就不会再提示
- 如果遇到问题，可以尝试使用不同的浏览器进行测试
